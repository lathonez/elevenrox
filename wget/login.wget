# attempt login
OUTFILE="login.out"
COOKIES="tenroxLite.cookies"
BASE_URL="https://openbet.tenrox.net/tenterprise/core/base/"
URL="logon.aspx?orgname=OpenBet"

# Headers we apparently don't need
HEADER_CONTENT="Content-type: application/x-www-form-urlencoded; charset=UTF-8"
HEADER_ENC="Accept-Encoding: gzip,deflate,sdc"
HEADER_X_REQ="X-Requested-With: XMLHttpReguest" # I don't think we should have this on as it isn't the case
HEADER_MS_AJAX="X-MicrosoftAjax: Delta=true" # For some reason setting this gives internal server error

# Post Variables we apparently don't need
DATA_CHANGED="E_IsDataChanged=true"
ASYNCPOST="__ASYNCPOST=true"
EVENTTARGET="__EVENTTARGET=btnLogon"
EVENTARG="__EVENTARGUMENT="
LASTFOCUS="__LASTFOCUS="
CSM="CommonScriptManager=UpdatePanel1|btnLogon"
EVENTVAL="__EVENTVALIDATION=/wEWCAKj5ryXAQKEoci9AQKNlp+TBAKk07qFCQKk07qFCQLb18frAwLb18frAwLlu4n5AzxyK4Gpx/xLbmApzjdFl7xLkxvL6+jFgq1mD2h1Km4e"

# Post Variables we do need
USERNAME="E_UserName=shazleto"
PASSWORD="E_Password=FCy3Kpzx"
VIEWSTATE="__VIEWSTATE=%2FwEPDwULLTE3NzMzMDYzNjMPZBYCAgMPZBYCAgMPZBYCZg9kFiJmDxYCHgVjbGFzcwUOdGVucm94X2xvZ29fZW5kAgEPDxYCHgRUZXh0BQVMb2dvbhYKHgNDRU4FBHRydWUeA0NNVgUEdHJ1ZR4DVE5YBQExHgV0aXRsZQUFTG9nb24eBXN0eWxlBRVkaXNwbGF5OmlubGluZS1ibG9jaztkAgIPFgIeCWlubmVyaHRtbAUuV2VsY29tZSB0byBUZW5yb3ggUHJvamVjdCBXb3JrZm9yY2UgTWFuYWdlbWVudGQCAw8PFgIfAQUNT3JnYW5pemF0aW9uOhYKHwIFBHRydWUfAwUEdHJ1ZR8EBQExHwUFDU9yZ2FuaXphdGlvbjofBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZAIEDw8WAh8BBQdPcGVuQmV0FgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQUHT3BlbkJldB8GBRVkaXNwbGF5OmlubGluZS1ibG9jaztkAgUPDxYCHwEFC0xvZ29uIG5hbWU6FgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQULTG9nb24gbmFtZTofBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZAIGDw8WBh4FV2lkdGgbAAAAAACAcUABAAAAHwFlHgRfIVNCAoACZGQCBw8PFgIfAQUJUGFzc3dvcmQ6FgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQUJUGFzc3dvcmQ6HwYFFWRpc3BsYXk6aW5saW5lLWJsb2NrO2QCCA8PFgQfCBsAAAAAAIBxQAEAAAAfCQKAAmRkAgkPDxYCHwEFBUxvZ29uZGQCCg9kFgJmDxYCHwEFBUxvZ29uZAILDxAPFgYfAQUcUmVtZW1iZXIgbWUgb24gdGhpcyBjb21wdXRlch4IQ3NzQ2xhc3MFBSB0Y2hrHwkCAhYEHwYFCWRpc3BsYXk6Ox4CaWQFDmNoa1JlbV93cmFwcGVyFgofAgUBMR8DBQExHgJDRGUeCHZhbGlkYXRlBQEwHwQFATFkZAIMDxYCHwcFFUZvcmdvdCB5b3VyIHBhc3N3b3JkP2QCDQ8PFgIfAQWaAVR5cGUgeW91ciBsb2dvbiBuYW1lIGFuZCBwYXNzd29yZC4gUGxlYXNlIG5vdGUgdGhhdCBwYXNzd29yZHMgYXJlIGNhc2Ugc2Vuc2l0aXZlLiBJZiB5b3UgZG8gbm90IGhhdmUgYW4gYWNjb3VudCwgcGxlYXNlIGNvbnRhY3QgeW91ciBTeXN0ZW0gQWRtaW5pc3RyYXRvci5kZAIODw8WAh8BBTNDb3B5cmlnaHQgMTk5NSAtIDIwMTEgIFRlbnJveC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4WCh8CBQR0cnVlHwMFBHRydWUfBAUBMR8FBTNDb3B5cmlnaHQgMTk5NSAtIDIwMTEgIFRlbnJveC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4fBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZAIPD2QWAmYPFgIfAQUSTGljZW5zZSBBZ3JlZW1lbnQuZAIRDw9kFgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBWUfBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUGY2hrUmVt20exLef%2BmW3bUyYaVRMrzey7Wo453aGEN8R1OT1KV7U%3D"

# ENTIRE POST NEEDS TO BE URL ENCODED.. OBVIOUSLY
POST=""$USERNAME"&"$PASSWORD"&"$VIEWSTATE

echo 'wget running with:'
echo 'URL: '$BASE_URL$URL
echo 'HEADER_CONENT: '$HEADER_CONTENT
echo 'HEADER_ENC: '$HEADER_ENC
echo 'POST: '$POST
echo ''

wget \
--output-document $OUTFILE \
--cookies=on \
--keep-session-cookies \
--save-cookies=$COOKIES \
--header="$HEADER_CONTENT" \
--header="$HEADER_ENC" \
--post-data $POST \
$BASE_URL$URL

