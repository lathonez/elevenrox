# attempt login
OUTFILE="login.out"
COOKIES="tenroxLite.cookies"
BASE_URL="https://openbet.tenroxhosting.com/tenterprise/core/base/"
URL="logon.aspx?orgname=OpenBet"

# Headers we apparently don't need
HEADER_CONTENT="Content-type: application/x-www-form-urlencoded; charset=UTF-8"
HEADER_ENC="Accept-Encoding: gzip,deflate,sdc"
HEADER_X_REQ="X-Requested-With: XMLHttpReguest" # I don't think we should have this on as it isn't the case
HEADER_MS_AJAX="X-MicrosoftAjax: Delta=true" # For some reason setting this gives internal server error

# Post Variables we apparently don't need
DATA_CHANGED="E_IsDataChanged=true"
ASYNCPOST="__ASYNCPOST=true"
EVENTTARGET="__EVENTTARGET=btnLogon"
EVENTARG="__EVENTARGUMENT="
LASTFOCUS="__LASTFOCUS="
CSM="CommonScriptManager=UpdatePanel1|btnLogon"
EVENTVAL="__EVENTVALIDATION=/wEWCAKj5ryXAQKEoci9AQKNlp+TBAKk07qFCQKk07qFCQLb18frAwLb18frAwLlu4n5AzxyK4Gpx/xLbmApzjdFl7xLkxvL6+jFgq1mD2h1Km4e"

# Post Variables we do need
USERNAME="E_UserName=shazleto"
PASSWORD="E_Password=8Vh7Ut84"
VIEWSTATE="__VIEWSTATE=%2FwEPDwULLTE3NzMzMDYzNjMPZBYCAgMPZBYCAgMPZBYCZg9kFiJmDxYCHgVjbGFzcwUOdGVucm94X2xvZ29fZW5kAgEPDxYCHgRUZXh0BQVMb2dvbhYKHgNDRU4FBHRydWUeA0NNVgUEdHJ1ZR4DVE5YBQExHgV0aXRsZQUFTG9nb24eBXN0eWxlBRVkaXNwbGF5OmlubGluZS1ibG9jaztkAgIPFgIeCWlubmVyaHRtbAUuV2VsY29tZSB0byBUZW5yb3ggUHJvamVjdCBXb3JrZm9yY2UgTWFuYWdlbWVudGQCAw8PFgIfAQUNT3JnYW5pemF0aW9uOhYKHwIFBHRydWUfAwUEdHJ1ZR8EBQExHwUFDU9yZ2FuaXphdGlvbjofBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZAIEDw8WAh8BBQdPcGVuQmV0FgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQUHT3BlbkJldB8GBRVkaXNwbGF5OmlubGluZS1ibG9jaztkAgUPDxYCHwEFC0xvZ29uIG5hbWU6FgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQULTG9nb24gbmFtZTofBgUVZGlzcGxheTppbmxpbmUtYmxvY2s7ZAIGDw8WBh4FV2lkdGgbAAAAAACAcUABAAAAHwEFCXNhZHNhZHNhZB4EXyFTQgKAAmRkAgcPDxYCHwEFCVBhc3N3b3JkOhYKHwIFBHRydWUfAwUEdHJ1ZR8EBQExHwUFCVBhc3N3b3JkOh8GBRVkaXNwbGF5OmlubGluZS1ibG9jaztkAggPDxYEHwgbAAAAAACAcUABAAAAHwkCgAJkZAIJDw8WAh8BBQVMb2dvbmRkAgoPZBYCZg8WAh8BBQVMb2dvbmQCCw8QDxYIHwEFHFJlbWVtYmVyIG1lIG9uIHRoaXMgY29tcHV0ZXIeCENzc0NsYXNzBQogdGNoayB0Y2hrHwkCAh4HQ2hlY2tlZGgWBB8GBQlkaXNwbGF5OjseAmlkBQ5jaGtSZW1fd3JhcHBlchYKHwIFATEfAwUBMR4CQ0RlHgh2YWxpZGF0ZQUBMB8EBQExZGQCDA8WAh8HBRVGb3Jnb3QgeW91ciBwYXNzd29yZD9kAg0PDxYCHwEFmgFUeXBlIHlvdXIgbG9nb24gbmFtZSBhbmQgcGFzc3dvcmQuIFBsZWFzZSBub3RlIHRoYXQgcGFzc3dvcmRzIGFyZSBjYXNlIHNlbnNpdGl2ZS4gSWYgeW91IGRvIG5vdCBoYXZlIGFuIGFjY291bnQsIHBsZWFzZSBjb250YWN0IHlvdXIgU3lzdGVtIEFkbWluaXN0cmF0b3IuZGQCDg8PFgIfAQUzQ29weXJpZ2h0IDE5OTUgLSAyMDExICBUZW5yb3guIEFsbCByaWdodHMgcmVzZXJ2ZWQuFgofAgUEdHJ1ZR8DBQR0cnVlHwQFATEfBQUzQ29weXJpZ2h0IDE5OTUgLSAyMDExICBUZW5yb3guIEFsbCByaWdodHMgcmVzZXJ2ZWQuHwYFFWRpc3BsYXk6aW5saW5lLWJsb2NrO2QCDw9kFgJmDxYCHwEFEkxpY2Vuc2UgQWdyZWVtZW50LmQCEQ8PZBYKHwIFBHRydWUfAwUEdHJ1ZR8EBQExHwVlHwYFFWRpc3BsYXk6aW5saW5lLWJsb2NrO2QYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFBmNoa1JlbeXi6UqllfKH45x0fMK4a4RTvvkQ0xOjCQx4jW7y1eaQ"

# ENTIRE POST NEEDS TO BE URL ENCODED.. OBVIOUSLY
POST=""$USERNAME"&"$PASSWORD"&"$VIEWSTATE

echo 'wget running with:'
echo 'URL: '$BASE_URL$URL
echo 'HEADER_CONENT: '$HEADER_CONTENT
echo 'HEADER_ENC: '$HEADER_ENC
echo 'POST: '$POST
echo ''

wget \
--output-document $OUTFILE \
--cookies=on \
--keep-session-cookies \
--save-cookies=$COOKIES \
--header="$HEADER_CONTENT" \
--header="$HEADER_ENC" \
--post-data $POST \
$BASE_URL$URL

